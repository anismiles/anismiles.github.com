"use strict";function StatusService(a,b,c,d){var e="http://webapp.relcy.com/redis/";return d(e,{key:"@key"},{getAllKeys:{method:"GET",url:e+"22/keys/*",responseType:"json"},getRecordByKeys:{method:"GET",url:e+"22/hgetall/:key",responseType:"json"},rejectRequest:{method:"GET",url:e+"22/hmset/:key/status/REJECTED",responseType:"json"},approveRequest:{method:"GET",url:e+"22/hmset/:key/status/APPROVED",responseType:"json"}})}angular.module("relcyEditorialApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/pending",{templateUrl:"views/pendingRecords.html",controller:"PendingController"}).when("/approved",{templateUrl:"views/approvedRecords.html",controller:"ApprovedController"}).when("/rejected",{templateUrl:"views/rejectedRecords.html",controller:"RejectedController"}).otherwise({redirectTo:"/"})}]),angular.module("relcyEditorialApp").controller("MainCtrl",["$scope","StatusService",function(a,b){function c(d,e){b.getRecordByKeys({key:d},function(b){if(b.hgetall.user=JSON.parse(b.hgetall.user),b.hgetall.smsent=b.hgetall.smsid?"Yes":"No","PENDING"==b.hgetall.status){try{var d=b.hgetall.user.user_data.third_party_data[0];"FACEBOOK"==d.third_party_service&&(b.hgetall.hasFBUrl=!0,b.hgetall.fbURL="https://www.facebook.com/"+d.fixed_id)}catch(f){b.hgetall.hasFBUrl=!1}a.pendingRecords.push(b.hgetall)}else if("APPROVED"==b.hgetall.status){try{var d=b.hgetall.user.user_data.third_party_data[0];"FACEBOOK"==d.third_party_service&&(b.hgetall.hasFBUrl=!0,b.hgetall.fbURL="https://www.facebook.com/"+d.fixed_id)}catch(f){b.hgetall.hasFBUrl=!1}a.approvedRecords.push(b.hgetall)}else a.rejectedRecords.push(b.hgetall);e++,a.keys.length>e&&c(a.keys[e],e)},function(a){console.log(a)})}a.keys=[],a.pendingRecords=[],a.approvedRecords=[],a.rejectedRecords=[],a.getKeys=function(){b.getAllKeys(function(b){a.keys=b.keys,c(a.keys[0],0)},function(a){console.log(a)})},a.rejectRequest=function(c,d){b.rejectRequest({key:c},function(b){if(1==b.hmset[0]){if("approve"==d){var e=_.find(a.approvedRecords,function(a){return a.user.invite_id==c});a.approvedRecords=_.without(a.approvedRecords,e),a.rejectedRecords.push(e)}if("pending"==d){var e=_.find(a.pendingRecords,function(a){return a.user.invite_id==c});a.pendingRecords=_.without(a.pendingRecords,e),a.rejectedRecords.push(e)}}},function(a){console.log(a)})},a.approveRequest=function(c,d){b.approveRequest({key:c},function(b){if(1==b.hmset[0]){if("reject"==d){var e=_.find(a.rejectedRecords,function(a){return a.user.invite_id==c});a.rejectedRecords=_.without(a.rejectedRecords,e),a.approvedRecords.push(e)}if("pending"==d){var e=_.find(a.pendingRecords,function(a){return a.user.invite_id==c});a.pendingRecords=_.without(a.pendingRecords,e),a.approvedRecords.push(e)}}},function(a){console.log(a)})},a.approve=function(b,c){a.approveRequest(b.user.invite_id,c)},a.reject=function(b,c){a.rejectRequest(b.user.invite_id,c)},a.showAllPendingApprovals=function(){},a.showAllApprovedUser=function(){},a.showAllRejectedUser=function(){},a.getKeys()}]),angular.module("relcyEditorialApp").controller("PendingController",["$scope","StatusService",function(a,b){function c(d,e){b.getRecordByKeys({key:d},function(b){if(b.hgetall.user=JSON.parse(b.hgetall.user),b.hgetall.smsent=b.hgetall.smsid?"Yes":"No","PENDING"==b.hgetall.status){try{var d=b.hgetall.user.user_data.third_party_data[0];"FACEBOOK"==d.third_party_service&&(b.hgetall.hasFBUrl=!0,b.hgetall.fbURL="https://www.facebook.com/"+d.fixed_id)}catch(f){b.hgetall.hasFBUrl=!1}a.pendingRecords.push(b.hgetall)}e++,a.keys.length>e&&c(a.keys[e],e)},function(a){console.log(a)})}a.keys=[],a.pendingRecords=[],a.getKeys=function(){b.getAllKeys(function(b){a.keys=b.keys,c(a.keys[0],0)},function(a){console.log(a)})},a.rejectRequest=function(c){b.rejectRequest({key:c},function(b){if(1==b.hmset[0]){var d=_.find(a.pendingRecords,function(a){return a.user.invite_id==c});a.pendingRecords=_.without(a.pendingRecords,d)}},function(a){console.log(a)})},a.approveRequest=function(c){b.approveRequest({key:c},function(b){if(1==b.hmset[0]){var d=_.find(a.pendingRecords,function(a){return a.user.invite_id==c});a.pendingRecords=_.without(a.pendingRecords,d)}},function(a){console.log(a)})},a.approve=function(b){a.approveRequest(b.user.invite_id,type)},a.reject=function(b){a.rejectRequest(b.user.invite_id,type)},a.getKeys()}]),angular.module("relcyEditorialApp").controller("ApprovedController",["$scope","StatusService",function(a,b){function c(d,e){b.getRecordByKeys({key:d},function(b){if(b.hgetall.user=JSON.parse(b.hgetall.user),b.hgetall.smsent=b.hgetall.smsid?"Yes":"No","APPROVED"==b.hgetall.status){try{var d=b.hgetall.user.user_data.third_party_data[0];"FACEBOOK"==d.third_party_service&&(b.hgetall.hasFBUrl=!0,b.hgetall.fbURL="https://www.facebook.com/"+d.fixed_id)}catch(f){b.hgetall.hasFBUrl=!1}a.approvedRecords.push(b.hgetall)}e++,a.keys.length>e&&c(a.keys[e],e)},function(a){console.log(a)})}a.keys=[],a.approvedRecords=[],a.getKeys=function(){b.getAllKeys(function(b){a.keys=b.keys,c(a.keys[0],0)},function(a){console.log(a)})},a.rejectRequest=function(c){b.rejectRequest({key:c},function(b){if(1==b.hmset[0]){var d=_.find(a.approvedRecords,function(a){return a.user.invite_id==c});a.approvedRecords=_.without(a.approvedRecords,d)}},function(a){console.log(a)})},a.reject=function(b,c){a.rejectRequest(b.user.invite_id)},a.getKeys()}]),angular.module("relcyEditorialApp").controller("RejectedController",["$scope","StatusService",function(a,b){function c(d,e){b.getRecordByKeys({key:d},function(b){b.hgetall.user=JSON.parse(b.hgetall.user),b.hgetall.smsent=b.hgetall.smsid?"Yes":"No","REJECTED"==b.hgetall.status&&a.rejectedRecords.push(b.hgetall),e++,a.keys.length>e&&c(a.keys[e],e)},function(a){console.log(a)})}a.keys=[],a.rejectedRecords=[],a.getKeys=function(){b.getAllKeys(function(b){a.keys=b.keys,c(a.keys[0],0)},function(a){console.log(a)})},a.approveRequest=function(c){b.approveRequest({key:c},function(b){if(1==b.hmset[0]){var d=_.find(a.rejectedRecords,function(a){return a.user.invite_id==c});a.rejectedRecords=_.without(a.rejectedRecords,d)}},function(a){console.log(a)})},a.approve=function(b,c){a.approveRequest(b.user.invite_id)},a.getKeys()}]),angular.module("relcyEditorialApp").service("StatusService",["$timeout","$q","$http","$resource",StatusService]);