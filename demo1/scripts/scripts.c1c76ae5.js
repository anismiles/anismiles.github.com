angular.module("relcyApp",["ui.router","ui.bootstrap","angucomplete-alt"]),angular.module("relcyApp").config(["$stateProvider","$urlRouterProvider","$httpProvider","$locationProvider",function(a,b,c,d){b.otherwise("home"),a.state("home",{url:"/home",templateUrl:"views/home.html",controller:"SearchController"})}]),angular.module("relcyApp").controller("SearchController",["$scope","$http","$rootScope","$location","SearchService","$filter",function(a,b,c,d,e,f){function g(a){return new Array(Math.floor(a))}function h(a){return a%1>0}function i(){for(var b=0;b<a.types.length;b++)if(a.hasResults(a.types[b].content_type_enum,b)){a.showResult(a.types[b].content_type_enum,b);break}}a.selectedTypeIndex=0,a.selected=0,a.showingResult=!1,a.query,a.showResult=function(b,c){a.selected=c,a.selectedTypeIndex=b,a.resultByType=a.types[c]},a.hasResults=function(b,c){switch(b){case"ENTERTAINMENT_VIDEO_MOVIE":return a.types[c]&&a.types[c].searchResultRelcy&&a.types[c].searchResultRelcy.results&&a.types[c].searchResultRelcy.results.length;case"WEB_VIDEOS":return a.types[c]&&a.types[c].videoSearchResult&&a.types[c].videoSearchResult.videoSearchResults&&a.types[c].videoSearchResult.videoSearchResults.length;case"WEB":return a.types[c]&&a.types[c].webSearchResult&&a.types[c].webSearchResult.searchResults&&a.types[c].webSearchResult.searchResults.length;case"APP":return a.types[c]&&a.types[c].searchResultRelcy&&a.types[c].searchResultRelcy.results&&a.types[c].searchResultRelcy.results.length;case"RELATED_SEARCHES":return a.types[c]&&a.types[c].relatedSearchesResult&&a.types[c].relatedSearchesResult.relatedSearchResults&&a.types[c].relatedSearchesResult.relatedSearchResults.length}},a.addScores=function(a){return a?(angular.forEach(a.autocomplete_items,function(a){a.scoreArray=g(a.score),a.showHalfRating=h(a.score)}),a):void 0},a.onInputChange=function(b){a.query=b},a.searchForSelection=function(b){b&&b.title&&a.search(b.title)},a.search=function(b){b&&(console.log(b),e.getSearchDetails(b).then(function(b){return a.showingResult=!0,a.result=b.search_response,a.result.verticalResult?(a.types=a.result.verticalResult,void i()):void(a.showingResult=!1)},function(b){a.showingResult=!1,a.gridMessage="Error while loading data"}))},a.clearSearchInput=function(b){a.$broadcast("angucomplete-alt:clearInput","members"),a.showingResult=!1,a.$broadcast("angucomplete-alt:clearInput",b)}}]),angular.module("relcyApp").service("SearchService",["$timeout","$q","$http",function(a,b,c){this.searchResult=[],this.getSearchDetails=function(a){var d="37.762759",e="-122.408934",f=b.defer();return c.get("http://staging-w.relcy.com/search?lat="+d+"&lng="+e+"&sessionId=b9a30926-e912-11e4-b02c-1681e6b88ec1&query="+a).success(function(a){f.resolve(a)}).error(function(a,b){f.reject(a)}),f.promise},this.search=function(a){var b="b9a30926-e912-11e4-b02c-1681e6b88ec1",d="37.762759",e="-122.408934",a=a,f=c({method:"get",url:"/test/arc-response-2015_Apr_24_12-21-31.json?sessionId="+b+"&lat="+d+"&lng="+e+"&query="+a});return f.then(this.handleSuccess,this.handleError)},this.handleError=function(a){return console.log(a),404==a.status&&"Result not available."==a.data?a:(console.log(a),b.reject(angular.isObject(a.data)&&a.data.message?a:a))},this.handleSuccess=function(a){var b=a.data;return b}}]);